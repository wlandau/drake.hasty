---
output: github_document
---

[![Travis build status](https://travis-ci.org/wlandau/drake.hasty.svg?branch=master)](https://travis-ci.org/wlandau/drake.hasty)

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
library(drake.hasty)
load_mtcars_example()
```

# Hasty mode for the drake R package

Hasty mode is accelerated execution with all of `drake`'s storage and reproducibility guarantees stripped away. For experimentation only. Use at your own risk.

## Drawbacks

- **DRAKE NO LONGER PROVIDES EVIDENCE THAT YOUR WORKFLOW IS TRUSTWORTHY OR REPRODUCIBLE. [THE CORE SCIENTIFIC CLAIMS](https://github.com/ropensci/drake#reproducibility-with-confidence) ARE NO LONGER VALID.**
- There is no cache. You need to write code to store your own targets. The `hasty_build` argument to `make()` and the `default_hasty_build()` function may help you get started.

## Advantages

- There is no overhead from storing and checking targets, so hasty mode runs much faster than `drake`'s standard modes.
- `drake` still builds the correct targets in the correct order, waiting for dependencies to finish before advancing downstream.

## Installation

```{r installhasty, eval = FALSE}
library(remotes)
install_github("wlandau/drake.hasty")
```

## Usage

First, create a `drake_config()` object from your workflow.

```{r introhasty}
library(drake.hasty)
load_mtcars_example()
config <- drake_config(my_plan, parallelism = backend_hasty)
```

You can increase speed even more with some lesser-known `drake_config()` options.

```{r hastyconfig}
config <- drake_config(
  my_plan,
  parallelism = backend_hasty,
  cache = storr::storr_environment(),
  skip_imports = TRUE,
  session_info = FALSE,
  skip_safety_checks = TRUE
)
```

Next, supply a funcion to build individual targets. Feel free to borrow from `default_hasty_build()`.

```{r hastybuild}
config$hasty_build <- default_hasty_build

config$hasty_build
```

Finally, run the project. For the fastest execution, set `skip_imports` to `TRUE`

```{r hastyrun1}
make(config = config)
```

There is no caching or checking in hasty mode, so your targets are never up to date.

```{r hastyrun2}
make(config = config)
```

If you have `clustermq` installed, you can use parallel computing.

```{r hastyrun3, eval = FALSE}
config$jobs <- 4
make(config = config)
```

```{r hastycleanup}
unlink(c("report.Rmd", "report.md"))
```
